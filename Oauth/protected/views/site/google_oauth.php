<?phpsession_start();require_once dirname(dirname(__DIR__)) . '/extensions/oauth2/vendor/autoload.php';$client = new Google_Client;$client->setClientId("761378352254-o0l2qpo769adpflfmvcp9ipbfkbhqva3.apps.googleusercontent.com");$client->setClientSecret("2hD7C7KRWgKo7ZqnIPH1jwZc");// 2) 使用者認證後，可取得 access_token if (isset($_GET['code'])) {    $client->setRedirectUri("http://www.oauth.jowinwin.com/oauth/index.php?r=site/google_oauth");    $result = $client->authenticate($_GET['code']);    if (isset($result['error'])) {        die($result['error_description']);    }    $_SESSION['google']['access_token'] = $result;    header("Location:http://www.oauth.jowinwin.com/oauth/index.php?r=site/google_oauth&action=profile");}// 3) 使用 id_token 取得使用者資料。另有 setAccessToken()、getAccessToken() 可以設定與取得 tokenelseif ($_GET['action'] == "profile") {    $client->setAccessToken($_SESSION['google']['access_token']);//    $people_service = new Google_Service_People($client);//    $me = $people_service->people->get('people/me');//    $oauth2 = new Google_Service_Oauth2($client);//    $me = $oauth2->userinfo->get();    $plus = new Google_Service_Plus($client);    $me = $plus->people->get('me');    echo "<pre>";    print_r($me);    echo "</pre>";    echo $me['emails'][0]['value'];    echo "<a href='http://www.oauth.jowinwin.com/oauth/index.php?r=site/google_oauth&action=logout'>Logout</a>";}// 1) 前往 Google 登入網址，請求用戶授權else {    $client->revokeToken();    session_destroy();    // 添加授權範圍，參考 https://developers.google.com/identity/protocols/googlescopes    $client->setScopes(array(//        "https://www.googleapis.com/auth/plus.login",//        "https://www.googleapis.com/auth/userinfo.email",//        "https://www.googleapis.com/auth/user.birthday.read",//        "https://www.googleapis.com/auth/user.addresses.read",//        "https://www.googleapis.com/auth/userinfo.profile",        "https://www.googleapis.com/auth/plus.me"    ));    $client->setRedirectUri("http://www.oauth.jowinwin.com/oauth/index.php?r=site/google_oauth");    $url = $client->createAuthUrl();    header("Location:{$url}");}if ($_GET['action'] == 'logout') {    unset($_SESSION);    $client->revokeToken();    header('Location: https://www.google.com/accounts/Logout?continue=https://appengine.google.com/_ah/logout?continue=http://www.oauth.jowinwin.com/oauth/index.php?r=site/google_oauth');}